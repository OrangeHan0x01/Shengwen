声闻--模块化视音频语音自动操作框架

简单介绍：
可以一键实现视频语音翻译到文本文件 或直接用一个文本文件和视频生成带字幕视频 以及其它用户能自定义的有用功能的（可能过度封装）框架/简单系统。
个人用户可以用三步实现简单的从视频生成带字幕视频：1、ubuntu的python3.6/3.7环境下下运行setup/install.sh（运行前看安装说明）2、注册百度智能云账号获得免费的百度语音识别api使用量，并对应修改general_config.conf中的变量。3、simple_exp.py中将输入输出文件路径改成自己的文件名，运行并等待（中途会暂停让你改字幕文件），最终得到你的带字幕视频（可能会被moviepy自动压缩，但moviepy文档说这是无损压缩）。
该框架为2021年国赛准备，可惜倒在了省赛，我觉得比上次比赛的项目实用很多，就把我负责和独立完成的部分放到github上了。web界面没有放上来，一是web界面由团队中其它成员完成，二是对于个人用户而言，直接运行一个脚本反而比web界面运行方便得多，web界面是给需要数据管理的用户准备的。
如果要识别其它语种，技术一般的用户尽量使用api并修改audio_process中的baiduSR模块。
如果想修改脚本实现自己的功能（以及已经基本封装好的在中途去除背景音，语音合成，或者需要修改字幕位置、颜色、字体等功能），请看一下process_exp.py和audio_process文件夹，注释应该已经给得很充分了。
如果要用masr离线模型识别,你还需要下载masr项目及预训练模型放到对应文件夹中，你可能还需要安装语言模型，请查看masr的说明。我原本为masr准备了一个微调模型的文件，但用处不大故没放进github版。


稍微麻烦点的介绍：
#按步骤划分的主要功能：
1、视频文件格式：环境是在ubuntu下，视频的处理使用了python的moviepy库，moviepy库支持几乎所有常见视频格式，因此不必做视频格式转换，如果有特殊需求的，也可以使用提供的ffmpeg工具进行视频格式转换。
2、提取语音：使用moviepy工具从视频中提取音频文件，之后使用spleeter工具，通过神经网络模型分割语音与背景音的音轨。
3、语音分割：使用基于BIC准则的语音分割工具，将一整段语音分割成以句子为单位的段。
4、语音识别：提供了2种识别方式：离线模型识别和百度api识别，离线模型使用全卷积的MASR模型，将wav格式音频转换为语谱图进行输入，并通过端到端的语言模型得到结果。此外，还在单独训练新模型之外提供了fine-tune文件，可以用少量数据微调masr模型最后一层，减少训练时间并使其与对应场景更匹配（但是百度api识别依然更准确，且在将来不必手动更新模型）。
5、语音合成与修改：使用pyttsx3库提供语音合成功能，可以自由调整合成语音的语速和音量，同时也提供录音用的程序和上传录音、在线编辑录音的网页接口，方便从音频中单独截取和修改。
6、视频添加字幕：使用moviepy+ImageMagick进行视频的字幕添加。

框架按照功能划分出各类模块，方便用户进行各种自定义的修改，例如，由于字幕生成与离线模型识别分开，用户可以轻松地通过将模型识别结果输入到'savetools'的'str_save'函数中而不改变框架的其它功能，实现调用自己的离线模型来方便更新换代的目标。

使用此项目时，建议将处理程序放置在与process_exp.py同目录下，否则需要将项目文件夹加入环境变量。

process_exp.py提供了可供快速上手的示例和说明，如果需要修改和自定义，建议阅读audio_process下的说明文件，对每个文件的函数和功能做出了一些解释。

硬件需求：
此项目既可以在专用服务器上使用，也可以在个人电脑上用作个人视音频的处理框架。由于提供了多种语音识别方式，对硬件没有特殊需求，但用户应该根据不同需求和情况选择进行语音识别的方式：1、网站使用，需要较大并发量、更高准确度以及减少语音识别技术更新换代时工作量的情形：使用百度语音api识别；2、个人项目使用、需要可以支持离线识别的情形：使用离线模型识别；3、想要在windows下使用、想要即时使用而尽可能少地安装依赖、想要减少磁盘容量占用的情形：使用百度语音api识别。

项目中这些部分参考使用了github开源项目：
离线语音识别模型：https://github.com/nobody132/masr
	我增加了一个fine-tune的代码文件，可在代替原本训练代码文件后实现微调模型适配下游任务的功能。
BIC语音分割：https://github.com/zheyejs/speech_seg
	由于部分库的更新，原本一些函数无法在我使用的python及这些库版本下运行，因此我修改了一些代码，引入了新的库来更换原本的函数。

